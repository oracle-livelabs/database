{
  "paragraphs": [
    {
      "text": "%md\n# Why Enterprise Data Matters\n\n## Introduction\n\nIn this lab, you'll see why agents fail without enterprise data—and how connecting them to your business context transforms their usefulness.\n\nAgents don't show up understanding your organization. They don't know your policies, your workflows, or how decisions were handled last time. That knowledge lives in your enterprise data.\n\nYou'll first ask an agent business-specific questions it can't answer, then give it access to your data and see the difference.\n\nEstimated Time: 10 minutes\n\n### Objectives\n\n* Experience agent failure without business context\n* Create enterprise data tools for agents\n* See how data access transforms agent responses\n* Understand why enterprise data provides judgment and guardrails\n\n### Prerequisites\n\nThis lab assumes you have:\n\n* Completed Labs 1-5 or have a working agent setup\n* An AI profile named `genai` already configured\n\n## Task 1: Experience the Knowledge Gap\n\nLet's see what happens when an agent doesn't have access to your business data.\n\n1. Create a simple agent without data access.",
      "config": { "colWidth": 12.0, "enabled": true, "results": {}, "editorSetting": { "language": "md" } }
    },
    {
      "text": "%script\n-- Create a basic agent without enterprise data tools\nBEGIN\n    DBMS_CLOUD_AI_AGENT.CREATE_AGENT(\n        agent_name  => 'CLUELESS_AGENT',\n        attributes  => '{\"profile_name\": \"genai\",\n                        \"role\": \"You are a customer service agent for TechCorp. Help customers with their inquiries.\"}',\n        description => 'Agent without enterprise data'\n    );\nEXCEPTION WHEN OTHERS THEN NULL;\nEND;\n/\n\nBEGIN\n    DBMS_CLOUD_AI_AGENT.CREATE_TASK(\n        task_name   => 'CLUELESS_TASK',\n        attributes  => '{\"instruction\": \"Help the customer: {query}\"}',\n        description => 'Task without data tools'\n    );\nEXCEPTION WHEN OTHERS THEN NULL;\nEND;\n/\n\nBEGIN\n    DBMS_CLOUD_AI_AGENT.CREATE_TEAM(\n        team_name   => 'CLUELESS_TEAM',\n        attributes  => '{\"agents\": [{\"name\": \"CLUELESS_AGENT\", \"task\": \"CLUELESS_TASK\"}],\n                        \"process\": \"sequential\"}',\n        description => 'Team without enterprise data'\n    );\nEXCEPTION WHEN OTHERS THEN NULL;\nEND;\n/",
      "config": { "colWidth": 12.0, "enabled": true, "results": {}, "editorSetting": { "language": "sql" } }
    },
    {
      "text": "%md\n2. Ask business-specific questions.",
      "config": { "colWidth": 12.0, "enabled": true, "results": {}, "editorSetting": { "language": "md" } }
    },
    {
      "text": "%script\nEXEC DBMS_CLOUD_AI_AGENT.SET_TEAM('CLUELESS_TEAM');\nSELECT AI AGENT What is the return policy for premium members;",
      "config": { "colWidth": 12.0, "enabled": true, "results": {}, "editorSetting": { "language": "sql" } }
    },
    {
      "text": "%md\nThe agent gives a generic response—it doesn't know YOUR return policy.\n\n3. Ask about a specific customer.",
      "config": { "colWidth": 12.0, "enabled": true, "results": {}, "editorSetting": { "language": "md" } }
    },
    {
      "text": "%script\nSELECT AI AGENT Is customer CUST-1001 eligible for an upgrade;",
      "config": { "colWidth": 12.0, "enabled": true, "results": {}, "editorSetting": { "language": "sql" } }
    },
    {
      "text": "%md\nThe agent can't answer—it has no customer data.\n\n## Task 2: Create Enterprise Data\n\nNow let's create the business data that the agent needs.\n\n1. Create policy and customer tables.",
      "config": { "colWidth": 12.0, "enabled": true, "results": {}, "editorSetting": { "language": "md" } }
    },
    {
      "text": "%script\n-- Company policies\nCREATE TABLE company_policies (\n    policy_id    VARCHAR2(20) PRIMARY KEY,\n    policy_name  VARCHAR2(100),\n    policy_text  CLOB,\n    applies_to   VARCHAR2(50)\n);\n\nINSERT INTO company_policies VALUES (\n    'POL-001', 'Return Policy - Premium',\n    'Premium members may return items within 90 days for full refund, no questions asked. ' ||\n    'Standard restocking fees are waived. Free return shipping included.',\n    'PREMIUM'\n);\n\nINSERT INTO company_policies VALUES (\n    'POL-002', 'Return Policy - Standard',\n    'Standard members may return items within 30 days. A 15% restocking fee applies. ' ||\n    'Customer pays return shipping.',\n    'STANDARD'\n);\n\nINSERT INTO company_policies VALUES (\n    'POL-003', 'Escalation Process',\n    'Billing disputes: 1) Agent attempts resolution, 2) If over $100, escalate to Team Lead, ' ||\n    '3) If unresolved after 24 hours, escalate to Manager, 4) Customer may request VP review.',\n    'ALL'\n);\n\n-- Customer data\nCREATE TABLE enterprise_customers (\n    customer_id   VARCHAR2(20) PRIMARY KEY,\n    name          VARCHAR2(100),\n    tier          VARCHAR2(20),\n    since         DATE,\n    total_spend   NUMBER(12,2),\n    upgrade_eligible VARCHAR2(1)\n);\n\nINSERT INTO enterprise_customers VALUES ('CUST-1001', 'Acme Corp', 'STANDARD', DATE '2022-01-15', 45000, 'Y');\nINSERT INTO enterprise_customers VALUES ('CUST-1002', 'TechStart', 'PREMIUM', DATE '2020-06-01', 125000, 'N');\nINSERT INTO enterprise_customers VALUES ('CUST-1003', 'NewCo', 'STANDARD', DATE '2024-01-10', 5000, 'N');\n\nCOMMIT;",
      "config": { "colWidth": 12.0, "enabled": true, "results": {}, "editorSetting": { "language": "sql" } }
    },
    {
      "text": "%md\n2. Create tool functions to access this data.",
      "config": { "colWidth": 12.0, "enabled": true, "results": {}, "editorSetting": { "language": "md" } }
    },
    {
      "text": "%script\n-- Tool to look up policies\nCREATE OR REPLACE FUNCTION get_policy(\n    p_policy_type VARCHAR2,\n    p_member_tier VARCHAR2 DEFAULT NULL\n) RETURN VARCHAR2 AS\n    v_result CLOB := '';\nBEGIN\n    FOR rec IN (\n        SELECT policy_name, policy_text \n        FROM company_policies \n        WHERE UPPER(policy_name) LIKE '%' || UPPER(p_policy_type) || '%'\n        AND (applies_to = p_member_tier OR applies_to = 'ALL' OR p_member_tier IS NULL)\n    ) LOOP\n        v_result := v_result || rec.policy_name || ': ' || rec.policy_text || CHR(10);\n    END LOOP;\n    \n    IF v_result IS NULL THEN\n        RETURN 'No policy found for: ' || p_policy_type;\n    END IF;\n    RETURN v_result;\nEND;\n/\n\n-- Tool to look up customer\nCREATE OR REPLACE FUNCTION get_customer_info(\n    p_customer_id VARCHAR2\n) RETURN VARCHAR2 AS\n    v_result VARCHAR2(500);\nBEGIN\n    SELECT 'Customer: ' || name || ', Tier: ' || tier || \n           ', Member since: ' || TO_CHAR(since, 'YYYY-MM-DD') ||\n           ', Total spend: $' || TO_CHAR(total_spend, '999,999') ||\n           ', Upgrade eligible: ' || upgrade_eligible\n    INTO v_result\n    FROM enterprise_customers\n    WHERE customer_id = p_customer_id;\n    \n    RETURN v_result;\nEXCEPTION\n    WHEN NO_DATA_FOUND THEN\n        RETURN 'Customer not found: ' || p_customer_id;\nEND;\n/",
      "config": { "colWidth": 12.0, "enabled": true, "results": {}, "editorSetting": { "language": "sql" } }
    },
    {
      "text": "%md\n3. Register the tools.",
      "config": { "colWidth": 12.0, "enabled": true, "results": {}, "editorSetting": { "language": "md" } }
    },
    {
      "text": "%script\nBEGIN\n    DBMS_CLOUD_AI_AGENT.CREATE_TOOL(\n        tool_name   => 'POLICY_LOOKUP_TOOL',\n        attributes  => '{\"instruction\": \"Look up company policies. Parameters: P_POLICY_TYPE (e.g. return, escalation), P_MEMBER_TIER (PREMIUM or STANDARD, optional). Always use this to answer policy questions.\",\n                        \"function\": \"get_policy\"}',\n        description => 'Retrieves company policies including return policies and escalation procedures'\n    );\n    \n    DBMS_CLOUD_AI_AGENT.CREATE_TOOL(\n        tool_name   => 'CUSTOMER_LOOKUP_TOOL',\n        attributes  => '{\"instruction\": \"Look up customer information. Parameter: P_CUSTOMER_ID (e.g. CUST-1001). Returns tier, spend, and upgrade eligibility. Always use this when asked about specific customers.\",\n                        \"function\": \"get_customer_info\"}',\n        description => 'Retrieves customer details including tier, spend history, and upgrade eligibility'\n    );\nEND;\n/",
      "config": { "colWidth": 12.0, "enabled": true, "results": {}, "editorSetting": { "language": "sql" } }
    },
    {
      "text": "%md\n## Task 3: Create an Informed Agent\n\nNow let's create an agent with access to enterprise data.\n\n1. Create the informed agent.",
      "config": { "colWidth": 12.0, "enabled": true, "results": {}, "editorSetting": { "language": "md" } }
    },
    {
      "text": "%script\nBEGIN\n    DBMS_CLOUD_AI_AGENT.CREATE_AGENT(\n        agent_name  => 'INFORMED_AGENT',\n        attributes  => '{\"profile_name\": \"genai\",\n                        \"role\": \"You are a customer service agent for TechCorp. You have access to company policies and customer information. Always use your tools to look up real data - never guess.\"}',\n        description => 'Agent with enterprise data access'\n    );\n    \n    DBMS_CLOUD_AI_AGENT.CREATE_TASK(\n        task_name   => 'INFORMED_TASK',\n        attributes  => '{\"instruction\": \"Help the customer by looking up relevant policies and customer information using your tools. Do not ask clarifying questions - use the tools and report what you find. User request: {query}\",\n                        \"tools\": [\"POLICY_LOOKUP_TOOL\", \"CUSTOMER_LOOKUP_TOOL\"]}',\n        description => 'Task with data access'\n    );\n    \n    DBMS_CLOUD_AI_AGENT.CREATE_TEAM(\n        team_name   => 'INFORMED_TEAM',\n        attributes  => '{\"agents\": [{\"name\": \"INFORMED_AGENT\", \"task\": \"INFORMED_TASK\"}],\n                        \"process\": \"sequential\"}',\n        description => 'Team with enterprise data'\n    );\nEND;\n/",
      "config": { "colWidth": 12.0, "enabled": true, "results": {}, "editorSetting": { "language": "sql" } }
    },
    {
      "text": "%md\n2. Set the new team.",
      "config": { "colWidth": 12.0, "enabled": true, "results": {}, "editorSetting": { "language": "md" } }
    },
    {
      "text": "%script\nEXEC DBMS_CLOUD_AI_AGENT.SET_TEAM('INFORMED_TEAM');",
      "config": { "colWidth": 12.0, "enabled": true, "results": {}, "editorSetting": { "language": "sql" } }
    },
    {
      "text": "%md\n## Task 4: Ask the Same Questions Again\n\nNow let's see the difference.\n\n1. Ask about return policy for premium members.",
      "config": { "colWidth": 12.0, "enabled": true, "results": {}, "editorSetting": { "language": "md" } }
    },
    {
      "text": "%script\nSELECT AI AGENT What is the return policy for premium members;",
      "config": { "colWidth": 12.0, "enabled": true, "results": {}, "editorSetting": { "language": "sql" } }
    },
    {
      "text": "%md\n**Now you get YOUR actual policy:** 90 days, no questions, waived fees, free shipping.\n\n2. Ask about the specific customer.",
      "config": { "colWidth": 12.0, "enabled": true, "results": {}, "editorSetting": { "language": "md" } }
    },
    {
      "text": "%script\nSELECT AI AGENT Is customer CUST-1001 eligible for an upgrade;",
      "config": { "colWidth": 12.0, "enabled": true, "results": {}, "editorSetting": { "language": "sql" } }
    },
    {
      "text": "%md\n**The agent looks up the customer and reports:** Yes, Acme Corp is eligible for upgrade.\n\n3. Ask about escalation.",
      "config": { "colWidth": 12.0, "enabled": true, "results": {}, "editorSetting": { "language": "md" } }
    },
    {
      "text": "%script\nSELECT AI AGENT What is the escalation process for billing disputes;",
      "config": { "colWidth": 12.0, "enabled": true, "results": {}, "editorSetting": { "language": "sql" } }
    },
    {
      "text": "%md\n**Your actual process:** Agent first, Team Lead if over $100, Manager after 24 hours, VP if requested.\n\n## Task 5: See the Tool Calls\n\nLet's verify the agent is using enterprise data.\n\n1. Query tool history.",
      "config": { "colWidth": 12.0, "enabled": true, "results": {}, "editorSetting": { "language": "md" } }
    },
    {
      "text": "%script\nSELECT \n    tool_name,\n    TO_CHAR(start_date, 'HH24:MI:SS') as when,\n    SUBSTR(output, 1, 60) as result\nFROM USER_AI_AGENT_TOOL_HISTORY\nORDER BY start_date DESC\nFETCH FIRST 10 ROWS ONLY;",
      "config": { "colWidth": 12.0, "enabled": true, "results": {}, "editorSetting": { "language": "sql" } }
    },
    {
      "text": "%md\n## Summary\n\nIn this lab, you experienced the difference enterprise data makes:\n\n* Saw an agent fail without business context\n* Created enterprise data tables and tool access\n* Watched the same questions get vastly better answers\n* Understood why enterprise data is essential\n\n**Key takeaway:** Agents don't fail because they're not smart—they fail because they don't know your business. Enterprise data is what transforms generic AI into your AI.\n\n## Learn More\n\n* [DBMS_CLOUD_AI_AGENT Package](https://docs.oracle.com/en/cloud/paas/autonomous-database/serverless/adbsb/dbms-cloud-ai-agent-package.html)\n\n## Acknowledgements\n\n* **Author** - David Start\n* **Last Updated By/Date** - David Start, January 2026",
      "config": { "colWidth": 12.0, "enabled": true, "results": {}, "editorSetting": { "language": "md" } }
    },
    {
      "text": "%md\n## Cleanup (Optional)",
      "config": { "colWidth": 12.0, "enabled": true, "results": {}, "editorSetting": { "language": "md" } }
    },
    {
      "text": "%script\nEXEC DBMS_CLOUD_AI_AGENT.DROP_TEAM('CLUELESS_TEAM', TRUE);\nEXEC DBMS_CLOUD_AI_AGENT.DROP_TEAM('INFORMED_TEAM', TRUE);\nEXEC DBMS_CLOUD_AI_AGENT.DROP_TASK('CLUELESS_TASK', TRUE);\nEXEC DBMS_CLOUD_AI_AGENT.DROP_TASK('INFORMED_TASK', TRUE);\nEXEC DBMS_CLOUD_AI_AGENT.DROP_AGENT('CLUELESS_AGENT', TRUE);\nEXEC DBMS_CLOUD_AI_AGENT.DROP_AGENT('INFORMED_AGENT', TRUE);\nEXEC DBMS_CLOUD_AI_AGENT.DROP_TOOL('POLICY_LOOKUP_TOOL', TRUE);\nEXEC DBMS_CLOUD_AI_AGENT.DROP_TOOL('CUSTOMER_LOOKUP_TOOL', TRUE);\nDROP TABLE company_policies PURGE;\nDROP TABLE enterprise_customers PURGE;\nDROP FUNCTION get_policy;\nDROP FUNCTION get_customer_info;",
      "config": { "colWidth": 12.0, "enabled": true, "results": {}, "editorSetting": { "language": "sql" } }
    }
  ],
  "name": "Lab 6 - Enterprise Data",
  "id": "lab6-enterprise-data",
  "noteParams": {},
  "noteForms": {},
  "angularObjects": {},
  "config": { "isZeppelinNotebookCronEnable": false },
  "info": {}
}
